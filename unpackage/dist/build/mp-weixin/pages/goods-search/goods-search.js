(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods-search/goods-search"],{"0db1":function(t,a,e){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var s=getApp(),n=function(){e.e("components/quick-nav/quick-nav").then(function(){return resolve(e("3783"))}.bind(null,e)).catch(e.oe)},i=function(){e.e("components/popup/popup").then(function(){return resolve(e("b1e3"))}.bind(null,e)).catch(e.oe)},o=function(){e.e("components/no-data/no-data").then(function(){return resolve(e("126b"))}.bind(null,e)).catch(e.oe)},l=function(){e.e("components/bottom-line/bottom-line").then(function(){return resolve(e("e5fd"))}.bind(null,e)).catch(e.oe)},_=s.globalData.get_static_url("common"),r={data:function(){return{common_static_url:_,data_list_loding_status:1,data_bottom_line_status:!1,data_list:[],data_total:0,data_page_total:0,data_page:1,params:null,post_data:{},is_show_popup_form:!1,popup_form_loading_status:!1,share_info:{},search_nav_sort_list:[{name:"综合",field:"default",sort:"asc",icon:null},{name:"销量",field:"sales_count",sort:"asc",icon:"default"},{name:"热度",field:"access_count",sort:"asc",icon:"default"},{name:"价格",field:"min_price",sort:"asc",icon:"default"},{name:"最新",field:"id",sort:"asc",icon:"default"}],currency_symbol:s.globalData.data.currency_symbol,search_map_list:{brand_list:[],category_list:[],screening_price_list:[],goods_params_list:[],goods_spec_list:[]},search_map_info:[],map_fields_list:{brand_list:{height:"100rpx",default:"100rpx",form_key:"brand_ids"},category_list:{height:"82rpx",default:"82rpx",form_key:"category_ids"},screening_price_list:{height:"82rpx",default:"82rpx",form_key:"screening_price_values"},goods_params_list:{height:"82rpx",default:"82rpx",form_key:"goods_params_values"},goods_spec_list:{height:"82rpx",default:"82rpx",form_key:"goods_spec_values"}},plugins_label_data:null}},components:{componentQuickNav:n,componentPopup:i,componentNoData:o,componentBottomLine:l},props:{},onLoad:function(t){this.setData({params:t,post_data:{wd:t.keywords||""}})},onShow:function(){this.init(),this.init_config()},onPullDownRefresh:function(){this.setData({data_page:1}),this.get_data_list(1)},methods:{init_config:function(t){1==(t||!1)?this.setData({currency_symbol:s.globalData.get_config("currency_symbol")}):s.globalData.is_config(this,"init_config")},init:function(){this.get_data()},search_event:function(){this.setData({data_list:[],data_page:1}),this.get_data_list(1)},get_data:function(){var a=this;t.showLoading({title:"加载中...",mask:!0});var e=this.request_map_handle();t.request({url:s.globalData.get_request_url("index","search"),method:"POST",data:e,dataType:"json",success:function(e){if(t.hideLoading(),t.stopPullDownRefresh(),0==e.data.code){var n=e.data.data;a.setData({search_map_info:n.search_map_info||[],search_map_list:{brand_list:n.brand_list||[],category_list:n.category_list||[],screening_price_list:n.screening_price_list||[],goods_params_list:n.goods_params_list||[],goods_spec_list:n.goods_spec_list||[]},plugins_label_data:null==(n.plugins_label_data||null)||null==(n.plugins_label_data.base||null)||null==(n.plugins_label_data.data||null)||n.plugins_label_data.data.length<=0?null:n.plugins_label_data}),a.get_data_list(1)}else a.setData({data_list_loding_status:0}),s.globalData.showToast(e.data.msg);var i=a.params.category_id||0,o=a.params.brand_id||0,l=a.params.keywords||"";a.setData({share_info:{path:"/pages/goods-search/goods-search",query:"category_id="+i+"&brand_id="+o+"&keywords="+l}}),s.globalData.show_share_menu()},fail:function(){t.hideLoading(),t.stopPullDownRefresh(),a.setData({data_list_loding_status:2}),s.globalData.showToast("服务器请求出错")}})},get_data_list:function(a){var e=this;if(0==(a||0)&&1==this.data_bottom_line_status)return t.stopPullDownRefresh(),!1;t.showLoading({title:"加载中...",mask:!0});var n=this.request_map_handle();t.request({url:s.globalData.get_request_url("datalist","search"),method:"POST",data:n,dataType:"json",success:function(a){if(t.hideLoading(),t.stopPullDownRefresh(),0==a.data.code){var n=a.data.data;if(n.data.length>0){if(e.data_page<=1)var i=n.data;else{i=e.data_list||[];var o=n.data;for(var l in o)i.push(o[l])}e.setData({data_list:i,data_total:n.total,data_page_total:n.page_total,data_list_loding_status:3,data_page:e.data_page+1}),e.setData({data_bottom_line_status:e.data_page>1&&e.data_page>e.data_page_total})}else e.setData({data_list_loding_status:0,data_total:0}),e.data_page<=1&&e.setData({data_list:[],data_bottom_line_status:!1})}else e.setData({data_list_loding_status:0}),s.globalData.showToast(a.data.msg)},fail:function(){t.hideLoading(),t.stopPullDownRefresh(),e.setData({data_list_loding_status:2}),s.globalData.showToast("服务器请求出错")}})},request_map_handle:function(){var t=this.params,a=this.post_data;a["page"]=this.data_page,a["category_id"]=t["category_id"]||0,a["brand_id"]=t["brand_id"]||0;var e=this.map_fields_list,n=this.search_map_list;for(var i in e)if(null!=n[i]!=null&&n[i].length>0){var o={},l=0;for(var _ in n[i])if(1==(n[i][_]["active"]||0)){switch(i){case"screening_price_list":o[l]=n[i][_]["min_price"]+"-"+n[i][_]["max_price"];break;case"goods_params_list":case"goods_spec_list":o[l]=n[i][_]["value"];break;default:o[l]=n[i][_]["id"]}l++}a[e[i]["form_key"]]=s.globalData.get_length(o)>0?JSON.stringify(o):""}return a},scroll_lower:function(t){this.get_data_list()},form_submit_event:function(t){this.setData({post_data:t.detail.value,data_page:1}),this.popup_form_event_close(),this.get_data_list(1)},popup_form_event_close:function(t){this.setData({is_show_popup_form:!1})},popup_form_event_show:function(t){this.setData({is_show_popup_form:!0})},nav_sort_event:function(t){var a=t.currentTarget.dataset.index||0,e=this.post_data,s=this.search_nav_sort_list,n="desc"==s[a]["sort"]?"asc":"desc";for(var i in s)i!=a&&(null!=s[i]["icon"]&&(s[i]["icon"]="default"),s[i]["sort"]="desc");s[a]["sort"]=n,null!=s[a]["icon"]&&(s[a]["icon"]=n),e["order_by_field"]=s[a]["field"],e["order_by_type"]=n,this.setData({post_data:e,search_nav_sort_list:s,data_page:1}),this.get_data_list(1)},more_event:function(t){var a=t.currentTarget.dataset.value||null,e=this.map_fields_list;null!=a&&null!=(e[a]||null)&&(e[a]["height"]="auto"==e[a]["height"]?e[a]["default"]:"auto",this.setData({map_fields_list:e}))},map_item_event:function(t){var a=t.currentTarget.dataset.index,e=t.currentTarget.dataset.field,s=this.search_map_list;null!=(s[e]||null)&&null!=(s[e][a]||null)&&(s[e][a]["active"]=0==(s[e][a]["active"]||0)?1:0,this.setData({search_map_list:s}))},map_remove_event:function(t){var a=this.search_map_list,e=this.post_data;for(var s in e["wd"]="",a)if(null!=(a[s]||null)&&a[s].length>0)for(var n in a[s])a[s][n]["active"]=0;this.setData({search_map_list:a,post_data:e,is_show_popup_form:!1,data_page:1}),this.get_data_list(1)},url_event:function(t){s.globalData.url_event(t)}}};a.default=r}).call(this,e("543d")["default"])},"10bb":function(t,a,e){"use strict";e.r(a);var s=e("0db1"),n=e.n(s);for(var i in s)"default"!==i&&function(t){e.d(a,t,(function(){return s[t]}))}(i);a["default"]=n.a},2870:function(t,a,e){"use strict";var s=e("d91c"),n=e.n(s);n.a},"65b3":function(t,a,e){"use strict";(function(t){e("7abb");s(e("66fd"));var a=s(e("77dc"));function s(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(a.default)}).call(this,e("543d")["createPage"])},"77dc":function(t,a,e){"use strict";e.r(a);var s=e("e85d"),n=e("10bb");for(var i in n)"default"!==i&&function(t){e.d(a,t,(function(){return n[t]}))}(i);e("2870");var o,l=e("f0c5"),_=Object(l["a"])(n["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],o);a["default"]=_.exports},d91c:function(t,a,e){},e85d:function(t,a,e){"use strict";var s;e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return i})),e.d(a,"a",(function(){return s}));var n=function(){var t=this,a=t.$createElement,e=(t._self._c,t.data_list.length>0?t.__map(t.data_list,(function(a,e){var s=t.__get_orig(a),n=null!=(t.plugins_label_data||null)&&t.plugins_label_data.data.length>0?t.__map(t.plugins_label_data.data,(function(e,s){var n=t.__get_orig(e),i=e.goods_ids.indexOf(a.id);return{$orig:n,g0:i}})):null;return{$orig:s,l0:n}})):null);t.$mp.data=Object.assign({},{$root:{l1:e}})},i=[]}},[["65b3","common/runtime","common/vendor"]]]);